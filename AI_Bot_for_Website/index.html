<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="https://cdn-icons-png.flaticon.com/512/10026/10026264.png" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Dushyant Blog</title>
  </head>
  <body>
    <div id="root"></div>
    <!-- 💬 Chat Widget -->
    <script>
      (function(){
        //=== CONFIGURATION===
        const AGENT_NAME = "Dblog"; 
        const WIDGET_COLOR = "#1e90ff"; 
        const WIDGET_GRADIENT = "#67e8f9"; 
        const WIDGET_BASE_FONT = 16; 
        const WIDGET_WIDTH = 370;
        const WIDGET_HEIGHT = 500;
        const WIDGET_LOGO_URL = "";
        const BACKEND_URL = "https://mayanksharma460.app.n8n.cloud/webhook/e28a1b30-31bc-4891-8e8d-e30d01cf6f84/chat";

        // === CSS ===
        const style = document.createElement('style');
        style.textContent = `
        :root {
          --aichat-color: ${WIDGET_COLOR};
          --aichat-gradient: ${WIDGET_GRADIENT};
          --aichat-font-sz: ${WIDGET_BASE_FONT}px;
          --aichat-font-sz-lg: ${1.15 * WIDGET_BASE_FONT}px;
          --aichat-font-sz-title: ${1.3 * WIDGET_BASE_FONT}px;
          --aichat-width: ${WIDGET_WIDTH}px;
          --aichat-height: ${WIDGET_HEIGHT}px;
          --aichat-radius: 18px;
          --aichat-shadow: 0 8px 32px rgba(26,48,98,.14);
        }
        .aichat-btn {
          position:fixed; bottom:28px; right:28px; z-index:99;
          width:66px; height:66px; border-radius:50%; border:none;
          box-shadow:0 2px 12px rgba(30,144,255,0.16);
          background:linear-gradient(135deg, var(--aichat-color) 60%, var(--aichat-gradient) 100%);
          color:#fff; font-size:2em;
          display:flex; align-items:center; justify-content:center;
          cursor:pointer; outline:none;
          animation: popup .5s cubic-bezier(.38,1.58,.57,.91);
        }
        @keyframes popup { 0%{opacity:0;transform:scale(.7)} 100% {opacity:1;transform:scale(1)} }

        .aichat-widget {
          position:fixed; right:32px; bottom:108px; z-index:98;
          width:var(--aichat-width); min-height:400px; max-height:var(--aichat-height);
          background:#fff; border-radius:var(--aichat-radius); box-shadow:var(--aichat-shadow); 
          border:1.5px solid rgba(30,144,255,0.15);
          overflow:hidden;display:none;flex-direction:column;font-size:var(--aichat-font-sz);
          animation: dropin .45s cubic-bezier(.15,.78,.15,.87);
        }
        @keyframes dropin { from{opacity:0;transform:translateY(60px)} to{opacity:1;transform:translateY(0)} }

        .aichat-messages {
          flex: 1; overflow-y:auto; padding:18px; display:flex; flex-direction:column; gap:8px; 
          background: linear-gradient(180deg,#e6f7ff 0,#fff 200px);
          min-height:120px;
        }
        .aichat-message {
          margin:0; max-width:83%; min-width:70px; padding:11px 15px;
          border-radius:13px 13px 13px 3px; box-shadow:0 1px 6px rgba(80,150,243,.04); 
          font-size:var(--aichat-font-sz); line-height:1.5;
          word-break:break-word; animation:fadeInMsg .22s;
          background:#f5fafd;
        }
        @keyframes fadeInMsg {from{opacity:0;transform:translateY(14px)} to{opacity:1; transform:translateY(0)}}

        .aichat-user {align-self:flex-end; background:var(--aichat-color); color:#fff; border-radius:13px 13px 3px 13px;}
        .aichat-ai {align-self:flex-start; background:#f3f7fd; color:#234; }
        `;
        document.head.appendChild(style);

        // === DOM STRUCTURE ===
        const chatBtn = document.createElement("button");
        chatBtn.className = "aichat-btn";
        chatBtn.innerHTML = "💬";

        const chatWidget = document.createElement("div");
        chatWidget.className = "aichat-widget";

        chatWidget.innerHTML = `
          <div class="aichat-messages" id="messages"></div>
          <div style="display:flex; padding:10px; border-top:1px solid #eee;">
            <input id="chatInput" type="text" placeholder="Type a message..." style="flex:1; padding:10px; border-radius:8px; border:1px solid #ccc;">
            <button id="sendBtn" style="margin-left:8px; background:var(--aichat-color); color:#fff; border:none; border-radius:8px; padding:10px 14px;">Send</button>
          </div>
        `;

        document.body.appendChild(chatBtn);
        document.body.appendChild(chatWidget);

        const messagesEl = chatWidget.querySelector("#messages");
        const inputEl = chatWidget.querySelector("#chatInput");
        const sendBtn = chatWidget.querySelector("#sendBtn");

        let sessionId = Date.now().toString();

        // === FUNCTIONS ===
        function appendMsg(msg, sender){
          const el=document.createElement("div");
          el.className="aichat-message "+(sender==="user"?"aichat-user":"aichat-ai");
          el.textContent=msg;
          messagesEl.appendChild(el);
          messagesEl.scrollTop=messagesEl.scrollHeight;
        }

        function sendMessage(){
          const text=inputEl.value.trim();
          if(!text) return;
          appendMsg(text,"user");
          inputEl.value="";

          fetch(BACKEND_URL,{
            method:"POST",
            headers:{"Content-Type":"application/json"},
            body:JSON.stringify({message:text,session_id:sessionId})
          })
          .then(r=>r.json())
          .then(d=>{
            appendMsg(d.output||"Sorry, I didn’t get that.","ai");
          })
          .catch(()=>{
            appendMsg("⚠️ Failed to reach AI server.","ai");
          });
        }

        chatBtn.onclick=()=>{
          chatWidget.style.display=chatWidget.style.display==="flex"?"none":"flex";
          if(chatWidget.style.display==="flex") setTimeout(()=>inputEl.focus(),200);
        };
        sendBtn.onclick=sendMessage;
        inputEl.onkeypress=e=>{if(e.key==="Enter") sendMessage();};

      })();
    </script>
  </body>
</html>
